{% extends "clustering.html" %}

{% block title %}State Estimation{% endblock %}

{% block instructions %}
Paste or upload a tab- or space-separated file containing single-cell RNASeq data where each row is a gene and each column is a cell. 
{% endblock %}

{% block method %}
Cells don't have discrete jumps from one cell type to another. Instead, they have a smooth transition. Here we formalize this by assuming that the true state of a cell lies in the convex hull spanned by some extreme cell types as seen in the above figure. 

This is performed using the Poisson Convex Mixture Model framework. This framework performs Non-negative Matrix Factorization (NMF) with the added assumption that the matrix being factored is the true state matrix, whose sampled version is being observed. Just multiplying the two factor matrices gives us the unsampled estimate of the true state.
{% endblock %}

        

{% block input %}
    <form action="state_estimation/input" method="post" enctype=multipart/form-data>

        <div class="form-group">
            <label for="fileinput">Upload a tab-separated text file, where each row is a gene and each column is a cell.</label>
            <input type="file" id="fileinput" name="fileinput"></input>
        </div>
 

        <div class="form-group">
            <label for="startinput">OPTIONAL: upload starting positions for the cell type centers, where each row is a gene and each column is a cell type.</label>
            <input type="file" id="startinput" name="startinput"></input>
        </div>

        <div class="form-group">
            <label for="k">Number of states (k):</label>
            <input type=number id="k" name="k" value=2></input>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-default">Submit Data</button>
        </div>


        <!--
        <div class="form-group">
            <label for="textarea">Alternatively, paste the data in as a tab-separated file, where each row is a gene and each column is a cell.</label>
            <textarea cols=80 rows=15 id="textarea"></textarea>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-default">Submit Data</button>
        </div>
        -->
    </form>
{% endblock %}
